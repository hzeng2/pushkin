# Pushkin CLI

## Skip to section

* [install site](pushkin-cli.md#site)
* [install experiment](pushkin-cli.md#experiment)
* [prep](pushkin-cli.md#prep)
* [start](pushkin-cli.md#start)
* [stop](pushkin-cli.md#stop)
* [kill](pushkin-cli.md#kill)
* [armageddon](pushkin-cli.md#armageddon)
* [updateDB](pushkin-cli.md#updatedb)

The Pushkin command-line package is available via NPM. We highly recommend a global install in order to make working with Pushkin projects as easy as possible:

```bash
$ yarn global add pushkin-cli
```

Any subcommand that affects a specific project must be run from a folder inside the project you wish to modify.

The CLI has the following subcommands:

### install site

Syntax: `pushkin install site`

Downloads Pushkin site template. It first will prompt for which site template \(currently only "default"\), then which version. Most often, the latest version will be the best option.

### install experiment

Syntax: `pushkin install experiment`

Downloads an experiment template. First will prompt for which experiment template \(see current list [here](modifying-experiment-templates/#current-templates)\), then prompt for a version to be selected. Most often, the latest version will be the best option.

### prep

Syntax: `pushkin prep`

Run inside a Pushkin project to prepare Pushkin to be run. Packages generated by calling `npm pack` inside each experiment’s web page and api controllers directories are moved to the core Pushkin code, installed there, and linked to the core code. Previous modules are uninstalled and removed.

#### Details

The code for `prep` is a bit convoluted \(sorry\). It loops through each experiment in the experiments folder \(as defined by `pushkin.yaml`\). For each experiment, it does thie following:

* It compiles and then tarballs the api controllers. These are moved to `pushkin/api/tempPackages`. This package is then added as a local package to `pushkin/api/package.json`, which allows them to be called during production.
* It compiles the worker and then builds a docker image for it. It is then added to `docker-compose.dev.yml` so that docker knows to include it when the website is built.
* It compiles and tarballs `web page` and moves it to `pushkin/front-end/tempPackages`. This package is then added as a local package to `pushkin/front-end/tempPackages`.

Finally, it updates `pushkin/front-end/src/experiments.js` to list each experiment, along with key information from the experiment’s config file. This will be read by the front end to build the list of experiments to display to potential participants.

Note that before any of this happens, `prep` actually goes through and deletes all old tempPackages, cleans up the package.jsons and docker-compose-dev.yml and empties experiments.js. Thus, to delete an experiment, all you have to do is delete it’s folder from the experiment folder. \(Of course, that won’t get rid of the docker image for the worker, so you’ll need to clean those up by hand periodically.\)

### start

Syntax: `pushkin start`

Starts local deploy for debugging purposes.

### stop

Syntax: `pushkin stop`

Stops the local deploy. This will not remove the local docker images. To do that, see documentation for [pushkin kill](pushkin-cli.md#kill) and [pushkin armageddon](pushkin-cli.md#armageddon).

### kill

Syntax: `pushkin kill`

Removes all containers and volumes from local Docker, as well as pushkin-specific images. Sometimes, if you having issues developing or seeing updates to your Pushkin project, it may be helpful to run this command to ensure docker isn't holding any problematic code or issues in containers.

### armageddon

Syntax: `pushkin armageddon`

Complete reset of the local docker, including containers, volumes, and third-party images. Sometimes, if you having issues developing or seeing updates to your Pushkin project, it may be helpful to run this command to ensure docker isn't holding any problematic code or issues in containers/images. This may generate some error messages, which you can safely ignore.

### updateDB

Syntax: `pushkin updateDB`

Runs migrations and seeds for experiments to update the database. This is set up to ensure experiments using the same database \(as defined in `pushkin.yaml`\) are migrated at the same time to avoid errors with the knex\_migrations table.

